
```{r}
#| label: set up 
#| include: false

# Set working directory to project root (needed when rendering from subdirectory)
if (basename(getwd()) == "pages") {
  setwd("..")
}

source("V1/Scripts/V1_Dashboard_setup.R")

message("âœ… _setup.R successfully loaded!")





```

```{r}
#| label: last-update
#| include: false

if (!exists("latest_update_label") || !exists("latest_nowcast_dir")) {
  latest_dataset_info <- get_latest_dataset_info()
  latest_update_label <- latest_dataset_info$label
  latest_nowcast_dir <- latest_dataset_info$dir
}

```


```{r}
#| label: region overview
#| echo: false
#| message: false

region_for_page <- "East & Southeast Asia"

render_region_overview(
  region_name = region_for_page,
  region_plot_list = region_plot_list,
  region_callouts = region_callouts,
  map_lookup = region_map_lookup,
  latest_update_label = latest_update_label
)


```


```{r}
#| label: country plots
#| echo: false
#| message: false


country_order <- data %>%
  filter(Region == region_for_page) %>%
  distinct(Country) %>%
  pull(Country)

region_plots <- all_country_plots[country_order]
region_plots <- region_plots[!sapply(region_plots, is.null)]

render_country_plot_text_grid(
  plot_list = region_plots,
  summary_df = country_summary_df,
  title = region_for_page,
  data_status_df = country_data_status
)


```